image:
  repository: mysql
  tag: "8.0"
  pullPolicy: IfNotPresent

service:
  name: mysql
  port: 3306
  clusterIP: None

replicaCount: 1

auth:
  rootPassword: rootpass
  database: appdb
  username: appuser
  password: apppass

persistence:
  size: 200Mi
  accessModes:
    - ReadWriteOnce

initdb:
  enabled: true
  sql: |
    CREATE DATABASE IF NOT EXISTS appdb;

    CREATE USER IF NOT EXISTS 'appuser'@'%' IDENTIFIED BY 'apppass';
    GRANT ALL PRIVILEGES ON appdb.* TO 'appuser'@'%';

    CREATE USER IF NOT EXISTS 'appuser'@'localhost' IDENTIFIED BY 'apppass';
    GRANT ALL PRIVILEGES ON appdb.* TO 'appuser'@'localhost';

    FLUSH PRIVILEGES;

    USE appdb;

    CREATE TABLE IF NOT EXISTS counter (
      id INT PRIMARY KEY,
      visits INT
    );

    INSERT INTO counter (id, visits)
    VALUES (1, 0)
    ON DUPLICATE KEY UPDATE id=id;